# FieldShield Script
# Author: kahanap
# Date: 2/28/2012
# Modified by davidf@iri.com on 18 March 2015

/AUDIT=FSlog.xml

/INFILE="PATIENT_RECORD;DSN=Oracle"
    /PROCESS = ODBC
 
    /ALIAS=patient_record
    /FIELD=(IDNUMBER, TYPE=ASCII, POSITION=1, SEPARATOR="|")
    /FIELD=(NAME1, TYPE=ASCII, POSITION=2, SEPARATOR="|",EXT_FIELD="NAME")
    /FIELD=(AGE, TYPE=ASCII, POSITION=3, SEPARATOR="|")
    /FIELD=(EMAIL, TYPE=ASCII, POSITION=4, SEPARATOR="|")
    /FIELD=(PHONE, TYPE=ASCII, POSITION=5, SEPARATOR="|")
    /FIELD=(CREDIT_CARD, TYPE=ASCII, POSITION=6, SEPARATOR="|")
    /FIELD=(DRIVING_LICENSE, TYPE=ASCII, POSITION=7, SEPARATOR="|")
    /FIELD=(SSN, TYPE=ASCII, POSITION=8, SEPARATOR="|")
    /FIELD=(CITY, TYPE=ASCII, POSITION=9, SEPARATOR="|")
    /FIELD=(STATE, TYPE=ASCII, POSITION=10, SEPARATOR="|")
	
/SORT
/KEY=EMAIL

/OUTFILE="PATIENT_RECORD_ENCRYPTED;DSN=Oracle"
    /PROCESS=ODBC
    /CREATE
    /FIELD=(IDNUMBER, TYPE=ASCII, POSITION=1, SEPARATOR="|")
    /FIELD=(NAME1, TYPE=ASCII, POSITION=2, SEPARATOR="|")
    /FIELD=(AGE, TYPE=ASCII, POSITION=3, SEPARATOR="|")
    /FIELD=(EMAIL, TYPE=ASCII, POSITION=4, SEPARATOR="|")
    /FIELD=(PHONE, TYPE=ASCII, POSITION=5, SEPARATOR="|")
    /FIELD=(ENC_FP_CREDIT_CARD=enc_fp_aes256_alphanum(CREDIT_CARD, "file:password"), TYPE=ASCII, POSITION=6, SEPARATOR="|", EXT_FIELD="CREDIT_CARD")
    /FIELD=(ENC_FP_DRIVING_LICENSE=enc_fp_aes256_alphanum(DRIVING_LICENSE, "jayavel"), TYPE=ASCII, POSITION=7, SEPARATOR="|", EXT_FIELD="DRIVING_LICENSE")
    /FIELD=(SSN, TYPE=ASCII, POSITION=8, SEPARATOR="|")
    /FIELD=(CITY, TYPE=ASCII, POSITION=9, SEPARATOR="|")
    /FIELD=(STATE, TYPE=ASCII, POSITION=10, SEPARATOR="|")

/OUTFILE=stdout
    /FIELD=(IDNUMBER, TYPE=ASCII, POSITION=1, SEPARATOR="|")
    /FIELD=(PSEUDO_NAME1, TYPE=ASCII, POSITION=2, SEPARATOR="|", SET= "120326134642_NAME1_pseudo.set" [ NAME1 ])
    /FIELD=(CUSTOM_AGE=AGE + 10, TYPE=ASCII, POSITION=3, SEPARATOR="|")
    /FIELD=(EMAIL, TYPE=ASCII, POSITION=4, SEPARATOR="|")
    /FIELD=(MASK_PHONE=replace_chars(PHONE, "#", 1, 3, "^", 6, 3), TYPE=ASCII, POSITION=5, SEPARATOR="|")
    /FIELD=(ENC_AES128_CREDIT_CARD=enc_aes128(CREDIT_CARD, "secret23"), POSITION=6, SEPARATOR="|", TYPE=ASCII)
    /FIELD=(ENC_FP_DRIVING_LICENSE=enc_fp_aes256_alphanum(DRIVING_LICENSE, "jayavel"), TYPE=ASCII, POSITION=7, SEPARATOR="|", EXT_FIELD="DRIVING_LICENSE")
    /FIELD=(MASK_SSN=replace_chars(SSN, "*", 1, 3, "*", 5, 2), TYPE=ASCII, POSITION=8, SEPARATOR="|")
    /FIELD=(CITY, TYPE=ASCII, POSITION=9, SEPARATOR="|")
    /FIELD=(RAND_STATE, TYPE=ASCII, POSITION=10, SEPARATOR="|", RANDOM)